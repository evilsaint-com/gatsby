{"componentChunkName":"component---src-templates-blog-post-js","path":"/articles/fixing-common-errors-power-shell-remoting-from-kali/","result":{"pageContext":{"post":{"fields":{"slug":"/fixing-common-errors-power-shell-remoting-from-kali"},"excerpt":null,"frontmatter":{"date":"25th February 2022 ","title":"Fixing Common Errors PowerShell Remoting From Kali","description":"In this article, I will briefly explain how to fix common issues when trying to PowerShell Remote From Kalil.","tags":"error-message, kali-linux, powershell","posttype":"article"},"body":"\nAssuming you have powershell installed on Kali. \n\n// Insert link or brief description of installing PowerShell on Kali. \n\n\n\n## Problem 1\n\nWhen you try and perform PowerShell remoting the first time you will probably see the following error. \n\n\"Enter-PSSession: This parameter set requires WSMan, and no supported WSMan client library was found. WSMan is either not installed or unavailable for this system.\" \n\n```\n┌──(consultant㉿pentest)-[~]\n└─$ pwsh \nPowerShell 7.1.4\nCopyright (c) Microsoft Corporation.\n\nhttps://aka.ms/powershell\nType 'help' to get help.\n\nPS /home/consultant> $cred = Get-Credential\n\nPowerShell credential request\nEnter your credentials.\nUser: Administrator\nPassword for user Administrator: *********\n\nPS /home/consultant> Enter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\nEnter-PSSession: This parameter set requires WSMan, and no supported WSMan client library was found. WSMan is either not installed or unavailable for this system.\nPS /home/consultant> \n```\n<img src=\"/static/86717c1c-326e-405e-a56f-4bcb1d38a049.png\">\n\n\nThe problem here is that the library is looking for packages that do not exist. \n\n\nIn this case, our PowerShell is located in the following path `/opt/microsoft/powershell/7`\n\nif we do\n```\nldd /opt/microsoft/powershell/7/libmi.so \n\tlinux-vdso.so.1 (0x00007ffc7bbe9000)\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007ff9e2e02000)\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007ff9e2dfb000)\n\tlibpam.so.0 => /lib/x86_64-linux-gnu/libpam.so.0 (0x00007ff9e2de9000)\n\tlibssl.so.1.0.0 => not found\n\tlibcrypto.so.1.0.0 => not found\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007ff9e2c0f000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007ff9e3010000)\n\tlibaudit.so.1 => /lib/x86_64-linux-gnu/libaudit.so.1 (0x00007ff9e2bdb000)\n\tlibcap-ng.so.0 => /lib/x86_64-linux-gnu/libcap-ng.so.0 (0x00007ff9e2bd3000)\n\n```\n\n<img src=\"/static/adfdb756-450d-4869-a4d9-f6862bb0ba16.png\">\n\n\nIn that directory, we need to add our symlinks:\n\n\n```\ncd /usr/lib/x86_64-linux-gnu \nsudo ln -s /usr/lib/x86_64-linux-gnu/libssl.so.1.0.2 libssl.so.1.0.0\nsudo ln -s /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.2 libcrypto.so.1.0.0\n```\n<img src=\"/static/0743039e-e8ad-49d5-9d64-91588530b5f6.png\">\n\n\nNow fixed!\n\n\n## Problem 2\n\nYou get a `MI_RESULT_ACCESS_DENIED` error message.\n```\nEnter-PSSession : MI_RESULT_ACCESS_DENIED\n```\n\nThis is probably because you missed off the `-Authentication` flag on your command\n\nCheck if you are typing in something like this\n```\nEnter-PSSession -ComputerName 192.168.1.235 -Credential $cred \n```\n\nThe solution is to use `-Authentication Negotiate`\n```\nEnter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\n```\n\n\n## Problem 3\n\nErrors with non-Kerberos authentication i.e. because you are not domain-joined\n\nIf you have seen this error when trying to connect with Negotiate because you are not domain-joined. \n\n\"Enter-PSSession: Connecting to remote server 192.168.1.235 failed with the following error message : acquiring creds with username only failed An invalid name was supplied SPNEGO cannot find mechanisms to negotiate For more information, see the about_Remote_Troubleshooting Help topic.\"\n\nFrom trying to type in a command such as \n```\nPS /home/consultant> Enter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\nEnter-PSSession: Connecting to remote server 192.168.1.235 failed with the following error message : acquiring creds with username only failed An invalid name was supplied SPNEGO cannot find mechanisms to negotiate For more information, see the about_Remote_Troubleshooting Help topic.\n```\n<img src=\"/static/7a048cd7-7167-4242-9c30-710c29d5b01b.png\">\n\n\nThis is because you need the following package installed on your kali Linux\n```\nsudo apt-get install gss-ntlmssp\n```\n\nAfter this, you should be able to connect."},"prev":{"fields":{"slug":"/understand-net-bios-names-in-minutes"},"excerpt":null,"frontmatter":{"date":"26th February 2022 ","title":"Understand NetBIOS Names in Minutes","description":"This article serves as an introduction and quick reference to NetBIOS names","tags":null,"posttype":"article"},"body":"\nNetBIOS names made easy. This article serves as a simplified introduction to NetBIOS names and suffixes; consider this if you are running late for exam prep or having to debug output from your terminal.\n\nIf you wish you learn more about NetBIOS, see EvilSaint's article at https://evilsaint.com/article/protocol-dissection-netbios-smb/.\n\n## What is the purpose of NetBIOS?\n\nIt lets computers in a local area network to share resources.\n<img src=\"/static/832745c2-95cc-45f6-a712-56f0da41b6e4.png\">\n![]()\n\n## Does Linux support NetBIOS?\n\nYes - by installing SAMBA. \n\n## What are NetBIOS names?\n\nThese are names that have specific meanings. These meanings explain what the computer can do in context of NetBIOS resource sharing. \n\nBasic syntax of a NetBIOS name is:\n\n```\n<computername/domain/workgroup>  <suffix>  <type>\n```\n\nOr in form of an example,\n\n```\nMYCOMPUTER <00> UNIQUE\n```\n\nThe above example means:\n\n```\nMy computer is called \"MYCOMPUTER\". \nIt supports the Workstation Service (\"<00>\") which means that it supports file and printer sharing.\nMy computer name is the only one with this name in this network, making it \"UNIQUE\".\n```\n\nYour computer probably has <b>at least three</b> NetBIOS names (depending what is installed on it). I.e., your computer wears \"at least three different hats\",  \n\nYou can view your computers' NetBIOS names with:\n\n```\nnbtstat  -n\n```\n\nSample output is below.\n\n```\n       Name               Type         Status\n    ---------------------------------------------\n    MYCOMPUTER     <00>  UNIQUE      Registered\n    MYCOMPUTER     <20>  UNIQUE      Registered\n    WORKGROUP      <00>  GROUP       Registered\n```\n\nThe `status` just means it is registered by broadcast or with a WINS server; however this is not of interest for now.\n\nThe latter two NetBIOS names translate to:\n\n```\nMy computer is called \"MYCOMPUTER\". \nIt supports File Sharing (\"<20>\") which means that it shares files within the network. \nMy computer name is the only one with this name in this network, making it \"UNIQUE\".\n```\n\nand\n\n```\nMy computer is part of a \"WORKGROUP\" and not a domain. \nIt supports the Workstation Service (\"<00>\") which means that it supports file and printer sharing within the workgroup. \nThe Workgroup my computer is a part of is a \"GROUP\" and it other computers are part of this.\n```\n\nAs demonstrated above, NetBIOS names tend to identify the UNIQUE and GROUP attributes of the computer in question. \n\n## Unique\n\nA unique name applies to a single IP address.\n\nThe UNIQUE attribute refers to:\n\n* uniquename; workstation, server, etc,\n* username (in some cases)\n\n## Group - Domain vs Workgroup\n\nA group name, which applies to a subnet group of IP addresses\n\nThe WORKGROUP attribute refers to:\n\n* peer to peer network\n* users being able to login using their own device only\n* smaller group than a domain\n\nThe DOMAIN attribute refers to:\n\n* users being able to log in with their credentials to any \"office\" device\n* bigger group than a workgroup\n\n## Technical details - NetBIOS Names + Suffixes\n\nMost common ones.\n\nUNIQUE\n------\nCOMPUTERNAME\t\t<00>  UNIQUE\tWorkstation Service\t\t\tCan access network shares\nCOMPUTERNAME\t\t<03>  UNIQUE        Windows Messenger Service\t\tSends messages between users in network\nCOMPUTERNAME\t\t<06>  UNIQUE\tRemote Access Service                    Provides remote access services\t\t\t\nCOMPUTERNAME\t\t<20>  UNIQUE\tFile Service\t\t\t\t\tShares files in network\nCOMPUTERNAME\t\t<21>  UNIQUE\tRemote Access Service client\t\tActs as a remote access service client\nDOMAIN\t\t\t\t<1B>  UNIQUE\tDomain Master Browser\t\t\tPrimary Domain Controller of domain <-- <b>DC</b>\nWORKGROUP/DOMAIN\t<1D>  UNIQUE\tMaster Browser\t\t\t\tLocal browser server for subnet of domain or workgroup\n\nGROUP\n-----\nWORKGROUP/DOMAIN         <00>  GROUP  \tWorkgroup/domain name\tIs part of this workgroup or domain and can access shared resources within it\n__MSBROWSE__\t\t\t<01>  GROUP\t\tMaster Browser\t\t\tIs the primary browser for this workgroup/domain\nWORKGROUP/DOMAIN     \t<1C>  GROUP\t\tDomain Controllers \t\tIs part of Domain Controllers group of workgroup or domain\t\nWORKGROUP/DOMAIN     \t<1E>  GROUP\t\tBrowser Service Elections\tBrowser service election server\n\n\n## `net` commands to use\n\nAll `net` commands all use NetBIOS host names.\n\nTo list NetBIOS connections (file share, printer share), use:\n\n```\nnet use \nnet use UNC\n```\n\n\n\nTo check your computer, \nnbtstat -a IP ADDRESS\n\nYour computer name --> probably at least three NetBIOS names depending what installed with Windows NT.\n\nworkstation service = enables print and file sharing \nwin10 -- > automatically started on boot\nenable access to network shares\n\nover LAN\nfiles + printers \nsession layer\n\nservice or name record type such as host record, master browser record, domain controller recors, or other services\nindividual service --> suffix\nNetBIOS name --> mac 16 ASCII chars --> 16th char = suffix\n    --> HEX : 00 is one byte\n--> friendly name --> 15-char name : computer name, domain name, name of user logged on\n--> domain, computer or user name + service type / function\n\n\n\n\n\nhttps://en.wikipedia.org/wiki/NetBIOS\nFor unique names:\nsingle IP address\nworkstation\nserver\nmessenger service\n\n00: Workstation Service (workstation name)\n03: Windows Messenger service\n06: Remote Access Service\n20: File Service (also called Host Record)\n21: Remote Access Service client\n1B: Domain Master Browser – Primary Domain Controller for a domain\n1D: Master Browser\n\nFor group names:\n\n00: Workstation Service (workgroup/domain name)\n1C: Domain Controllers for a domain (group record with up to 25 IP addresses)\n1E: Browser Service Elections\n\n\nExample:\n\nWhat is \n<computername> 00 U\n\nA: Workstation \n\nhttps://evilsaint.com/article/protocol-dissection-netbios-smb/\nnbtscan <ip-range> \n\tNetBIOS name and MAC\n\nnbtscan -v -s : <ip-range>\n\tservice Identifier\n\n* workgroup `<00>` group - This name is a remnant of the original LAN Manager browse service.\n* workgroup `<1D>` unique - This name identifies the Local Master Browser (LMB, sometimes called simply \"Master Browser\") for a subnet. <-- SUBNET of DOMAIN or WORKGROUP(?)\n* workgroup `<1E>` -  group A node that is capable of acting as a \"Browser\" registers this group name to listen for election announcements.\n* nt_domain `<1B>` unique Name registered by the Domain Master Browser. Must be registered with the NBNS in order to be of any real use. <-- combines infor for DOMAIN = DOMAIN CONTROLLER\n* nt_domain `<1C>` Internet group Registered by all Domain Controllers in the given NT Domain.\n\nMASTER BROWSER : computer that \n\n\nHow to list for individual computer\n> nbtstat /a WIN-TUEFA0TGVTB\n--> Name: computer name\n--> Type: computer name type (unique or group)\n--> Status: registered / not\n\n distinguished by whether they are\n\n\nA multihomed name, which applies to a multicast group of IP addresses\n"},"next":{"fields":{"slug":"/wsl-2-installing-metasploit-framework-with-kali-linux"},"excerpt":null,"frontmatter":{"date":"25th February 2022 ","title":"WSL2 - Installing Metasploit Framework with Kali Linux","description":"This article demonstrates how to install the Metasploit Framework with Kali Linux on WSL2.","tags":"kali-linux, wsl2","posttype":"article"},"body":"\nThis article demonstrates how to install the Metasploit Framework with Kali Linux on WSL version 2. When installing Kali Linux for WSL2 using Microsoft Store, its file size is minimised by including the bare essentials by default.\n\n#Pre-requisites\n\nThis example assumes that you have the following:\n\n- Windows Subsystem For Linux version 2 (WSL2) - This example is not tested on WSL version 1\n- Kali Linux for WSL2\n\n#Instructions\n\n<h5 class=\"step\">Step 1 - Update the repositories</h5>\n\n```\nsudo apt update\n```\n\n<h5 class=\"step\">Step 2 - Install and enable PostgreSQL</h5>\n\n```\nsudo apt install postgresql\nsudo /etc/init.d/postgresql start\n```\n\n<h5 class=\"step\">Step 3 - Download the Metasploit Framework installation file</h5>\n\n```\nwget https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb\n```\n\n<h5 class=\"step\">Step 4 - Install the Metasploit Framework</h5>\n\n```\n./msfupdate.erb\n```\n\n<h5 class=\"step\">Step 5 -Verify the installation</h5>\n\nTo confirm that the Metasploit Framework was successfully installed, attempt to launch components supported by the framework.\n\nTo launch the Metasploit Framework command-line interface, run:\n\n```\nmsfconsole\n```\n\nThe below screen capture displays `msfconsole` launched with an ASCII-art banner.\n<img src=\"/static/429fbf45-6b3a-4372-8e75-15ad3e5d60cd.png\">\n![](/media/markdown/2022/02/26/)\n\nYou can use `exit` to exit msfconsole and attempt to launch the `msfvenom`, the command-line instance of Metasploit.\n\n```\nmsfconsole\n```\n\nIf the installation was successful, the help page will be displayed as demonstrated below.\n<img src=\"/static/fa427e84-580d-4edb-847d-e09776009dd1.png\">\n![](/media/markdown/2022/02/26/)"}}},"staticQueryHashes":["310218920"],"slicesMap":{}}