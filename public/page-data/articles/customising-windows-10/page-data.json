{"componentChunkName":"component---src-templates-blog-post-js","path":"/articles/customising-windows-10/","result":{"pageContext":{"post":{"fields":{"slug":"/customising-windows-10"},"excerpt":null,"frontmatter":{"date":"21st September 2020 ","title":"Customising Windows 10","description":"This guide is going to take you through a number of components to get your machine ready for subsequent parts of this guide.","tags":"customising-windows, vms, vmware, windows","posttype":"article"},"body":"\nThis guide is going to take you through a number of components to get your machine ready for subsequent parts of this guide. \n\n### Preparing\n\nHit the Windows key and type `cmd`.\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n  <img src=\"/static/734c9b10-1b51-4fb7-81d1-d56a5156429d.png\" class=\"img-fluid\" alt=\"Opening Windows CMD Prompt from Start Menu\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Opening Windows CMD Prompt from Start Menu.</figcaption>\n</figure>\n\nHold down `CTRL` + `SHIFT` and now hit the `Enter` key to open the command prompt as an elevated user. \n\nNow hit the Windows key and type `PowerShell`\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n  <img src=\"/static/e02c6fea-e50d-4b4d-9bf0-d6734745df23.png\" class=\"img-fluid\" alt=\"Elevated PowerShell Prompt\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Elevated PowerShell Prompt.</figcaption>\n</figure>\n\nHold down `CTRL` + `SHIFT` and now hit the `Enter` key to open the PowerShell prompt as an elevated user. \n\nWindows Version\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n  <img src=\"/static/1e875c32-3ae8-4948-b3c4-8d8d0704f647.png\" class=\"img-fluid\" alt=\"Windows Version Information Displayed Via winver Command\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Windows Version Information Displayed Via winver Command.</figcaption>\n</figure>\n\n## PowerShell 7\n\nQuick one-liner to install the latest version (PowerShell 7 is current at time of print) on Windows\n```\niex \"& { $(irm https://aka.ms/install-powershell.ps1) } -UseMSI\"\n```\n\nFollow the Wizard to the step headed \"Optional Actions\" and check the selection to \"Enable PowerShell remoting\". I also like to select \"Add 'Open here' context menus to Explorer\". \n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n <img src=\"/static/747d8148-d1a5-49f1-b37a-20a03d0726e4.png\" class=\"img-fluid\" alt=\"PowerShell 7 Installing Optional Actions\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">PowerShell 7 Installing Optional Actions.</figcaption>\n</figure>\n\nSelect the \"Launch PowerShell\" in the bottom left of the next wizard. \n\nNow \"Right Click\" the PowerShell icon and select \"Pin to taskbar\". \n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n <img src=\"/static/b5b9a5ef-6cab-469e-b646-cdf2e102ab88.png\" class=\"img-fluid\" alt=\"Right click pin to taskbar\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Right click pin to taskbar.</figcaption>\n</figure>\n\nNow enter `$PSVersionTable` to confirm the version of PowerShell. \n\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/d5102f1f-3474-4de9-b731-3c000bbff513.png\" class=\"img-fluid\" alt=\"PowerShell 7 Get Version Information with $PSVersionTable\"><figcaption class=\"figure-caption text-center fw-normal text-dark\">PowerShell 7 Get Version Information with $PSVersionTable.</figcaption>\n</figure>\n\nTo install on Linux\n```\nwget https://aka.ms/install-powershell.sh; sudo bash install-powershell.sh; rm install-powershell.sh\n```\n\n## WSL\n\nWSL version 2 is real Linux on real Windows :)\n\nNext, we will install the Windows Subsystem for Linux and the VirtualMachinePlatform. \n\nDism vs Enable-WindowsOptionalFeature\n\n```\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\n```\n\n```\nEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux -NoRestart\nEnable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform -NoRestart\n```\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/f01e5588-7993-4a9a-963f-0a6f28881677.png\" class=\"img-fluid\" alt=\"Installing Optional Features\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Installing Optional Features.</figcaption>\n</figure>\n\n\nSetting version 2 of the Windows Subsystem for Linux to the default\n```\nwsl –set-default-version 2\n```\n\nIf you get an error message saying \n    \n> WSL 2 requires an update to its kernel component. For information please visit https://aka.ms/wsl2kernel\n    \nThis means you need to install the MSI another component. \n\nGo to [https://aka.ms/wsl2kernel](https://aka.ms/wsl2kernel)\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/20b5093a-ed64-44f2-9f85-330caca77ad6.png\" class=\"img-fluid\" alt=\"Download the Linux Kernel Update package for WSLv2\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Download the Linux Kernel Update package for WSLv2.</figcaption>\n</figure>\n\nDownload by clicking the link \"WSL2 Linux kernel update package for x64 machines\"\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/c7684b40-9f63-46d9-aa4f-2ed48d6c4bfc.png\" class=\"img-fluid\" alt=\"Click the msi installer\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Click the msi installer.</figcaption>\n</figure>\n\nIf at this point you need to restart your virtual machine. \n```\nrestart-computer -Confirm\n```\n\nList various versions of Linux \n```\nwsl --list\nwsl -l -v\n```\n\nListing versions we can see the difference\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/dc8ef383-d7c5-4d2d-9be0-90afdb2b03ce.png\" class=\"img-fluid\" alt=\"Using the wsl --list versions command\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Using the wsl --list versions command.</figcaption>\n</figure>\n\nWe will want to upgrade any WSL Linux machines running version 1 (Hyper-V method)\n\nReasons to upgrade to WSLv2 [Reasons to Upgrade to WSLv2](https://docs.microsoft.com/en-gb/windows/wsl/about)\n\n```\nwsl --set-version kali-linux 2\n```\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/edde105e-d633-41fc-a530-09a3eea6a75d.png\" class=\"img-fluid\" alt=\"Coverting Kali-Linux WSLv1 to WSLv2\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Coverting Kali-Linux WSLv1 to WSLv2.</figcaption>\n</figure>\n\nRun the Kali Linux Distribution\n```\nwsl -d kali-linux\n```\n\n### Debugging\n\n```\nwsl --shutdown\ndism /Online /Cleanup-Image /RestoreHealth\n```\n\nInstall Code by typing `code .`\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/c40c343c-f360-46fb-8ac9-b4b008324e35.png\" class=\"img-fluid\" alt=\"Installing Visual Studio Code\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Installing Visual Studio Code.</figcaption>\n</figure>\n\nNow type `code .` again and watch as Visual Studio opens up in the Windows Host showing files from the WSL\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/c91f8c40-7c3e-4239-b2a2-6e2e4173bb37.png\" class=\"img-fluid\" alt=\"Running and Installing Visual Studio inside WSL\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Running and Installing Visual Studio inside WSL.</figcaption>\n</figure>\n\n\n## Docker for Windows\n\nRequirements\n\n* Windows 10 64-bit: Pro, Enterprise, or Education (Build 16299 or later).\n* Hyper-V and Containers Windows features must be enabled.\n\n> **Note** - For Windows Home Edition follow this link [https://docs.docker.com/docker-for-windows/install-windows-home/](https://docs.docker.com/docker-for-windows/install-windows-home/)\n\n1. Grab the installer [https://hub.docker.com/editions/community/docker-ce-desktop-windows/](https://hub.docker.com/editions/community/docker-ce-desktop-windows/)\n\n2. Double-click the blue \"Get Docker Desktop for Windows (stable)\" button to download the executable.\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/c92e6a86-96b6-4893-a656-865c78d9f0a4.png\" class=\"img-fluid\" alt=\"Docker Installer\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Docker Installer.</figcaption>\n</figure>\n\n3. Double-Click the \"Docker Desktop Installer.exe\" to run the installer.\n\n4. When prompted, ensure the Enable Hyper-V Windows Features option is selected on the Configuration page.\n\n5. Follow the instructions on the installation wizard to authorize the installer and proceed with the install.\n\n> If your admin account is different to your user account, you must add the user to the docker-users group. Run Computer Management as an administrator and navigate to  Local Users and Groups > Groups > docker-users. Right-click to add the user to the group. Log out and log back in for the changes to take effect.\n\n## Terminal App\n\nThe terminal app is seemingly turning out to be a boon for developers and those who have always looked at Windows machines with huge expectations. The open-source terminal app boasts a range of powerful features including multiple tabs, Unicode and UTF-8 character support, and GPU accelerated text rendering engine. It’s designed to be an all-in-one platform for Command Prompt, PowerShell, WSL and SSH so that developers can have seamless access to all the tools. Even better, this all-new command-line app also features custom themes and styles for a more personalized experience\n\n[Terminal App Releases](https://github.com/microsoft/terminal/releases/)\n\nThe new Shell\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/f62567a0-2ccb-4b42-a55c-a4e2d29a1a79.png\" class=\"img-fluid\" alt=\"The New Shell\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">The New Shell.</figcaption>\n</figure>\n\nPin terminal to the taskbar\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/94d8933c-ec62-43c3-afb0-6300e5dc86a3.png\" class=\"img-fluid\" alt=\"Pin terminal to the taskbar\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Pin terminal to the taskbar.</figcaption>\n</figure>\n\n## Customisation\n\n### Cascadia Fonts\n\nNext, I am going to install [Microsofts Cascadia Code Font](https://github.com/microsoft/cascadia-code/releases)\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/0223b9ef-976a-491a-bed5-c703f8b79a3f.png\" class=\"img-fluid\" alt=\"Pin terminal to the taskbar\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Pin terminal to the taskbar.</figcaption>\n</figure>\n\nClick \"Install for all users\"\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/2c1826a5-6222-4c83-9f06-9999146253f0.png\" class=\"img-fluid\" alt=\"Install Font for all users\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Install Font for all users.</figcaption>\n</figure>\n\n### Git\n\nInstall [Git for Windows](https://git-scm.com/download/win)\n\nPosh-Git adds Git status information to your prompt as well as tab-completion for Git commands, parameters, remotes, and branch names. Oh-My-Posh provides theme capabilities for your PowerShell prompt. PSReadline lets you customize the command line editing environment in PowerShell.\n\n```\nInstall-Module posh-git -Scope CurrentUser\nInstall-Module oh-my-posh -Scope CurrentUser\n```\n\nPowerShell Core\n```\nInstall-Module -Name PSReadLine -Scope CurrentUser -Force -SkipPublisherCheck\n```\n\nOh My Posh Themes\nPick a [theme for `Oh My Posh`](https://github.com/JanDeDobbeleer/oh-my-posh#themes)\n```\nImport-Module posh-git\nImport-Module oh-my-posh\nSet-Theme Paradox\n```\n\n###Customise your Kali\n\nInstall Powerline\n```\nsudo apt install golang-go\ngo get -u github.com/justjanne/powerline-go\n```\n\nInstall Hyper for Windows\nhttps://releases.hyper.is/download/win\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/03e3cc64-862a-4dd2-9b5a-460007938604.png\" class=\"img-fluid\" alt=\"Install Hyper For Windows\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Install Hyper For Windows.</figcaption>\n</figure>\n\nWith the Hypershell open, enter the following commands\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/ad210a8d-8793-4ffc-b538-7e36b1e2d0a4.png\" class=\"img-fluid\" alt=\"Open HyperShell\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Open HyperShell.</figcaption>\n</figure>\n\n**settings.json**\n\nThe settings.json file as the name suggests contains settings for the terminal application. A few of the important settings like what should be your default profile, color scheme, key bindings, etc can be found here.\n\nTo open the default.json file hold the alt key while opening the settings.json file as mentioned above.\n\n**defaults.json**\n\nThe defaults.json file contains all the default configuration values for the terminal. This file can be used for reference, as it is an auto-generated file and contains all complete default configuration of the terminal application.\n\n## Install Chocolatey\n\nFrom an elevated PowerShell Prompt\n```\nSet-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))\n```\n\nConfirm the installation of Chocolatey\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/47315b04-6d39-4fb7-b421-83d9e7f2b346.png\" class=\"img-fluid\" alt=\"Confirm the installation of Chocolatey\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Confirm the installation of Chocolatey.</figcaption>\n</figure>\n\nLet us install some packages\n\n```\nchoco install wsl-kalilinux\n```\n\n## FireEye Commando-vm\n\nDownload the latest from:\n[https://github.com/fireeye/commando-vm](https://github.com/fireeye/commando-vm)\n\nUnzip the folder.\n\nUse my custom profile evilsaint.json. \n\n<a href=\"evilsaint.json\" target=\"_blank\">Custom Profile</a>\n\nMy main additions are \n```\n{\"name\": \"wsl.fireeye\"},\n{\"name\": \"hyperv.fireeye\"},\n{\"name\": \"markdownmonster\"},\n{\"name\": \"wsl-ubuntu-2004\"},\n{\"name\": \"wsl-archlinux\"},\n{\"name\": \"wsl-debiangnulinux\"},\n{\"name\": \"microsoft-windows-terminal\"},\n{\"name\": \"everything\"},\n```\n\nI like to remove\n```\n{\"name\": \"burp.free.fireeye\"},\n```\n\n```\ncinst install <package>\n```\n\n```\ncup all\n```\n\n## Customising WSL\n\n### Kali Machine\n\n```\nsudo apt-get update\nsudo apt-get dist-upgrade\nsudo apt-get clean\nsudo apt-get --yes --force-yes install kali-desktop-xfce xorg xrdp\nsed -i 's/port=3389/port=3390/g' /etc/xrdp/xrdp.ini\nsudo apt install kali-win-kex\nsudo apt install kali-linux-large\n```\n\nRun Win-KeX\n\n* Windows mode\n* seamless mode\n\n## Moving Around \n\n```\nstart WT 'new-tab \"PowerShell\" ; split-pane -p \"KaliGeneral\" ; split-pane -H -p \"KaliC2\" | set-focus -n wsl.exe\n```\n\n```\nmkdir C:\\Users\\consultant\\AppData\\Local\\KaliC2\nwsl --import KaliC2 C:\\Users\\consultant\\AppData\\Local\\KaliC2 .\\kali-base.tar --version 1\nmkdir C:\\Users\\consultant\\AppData\\Local\\KaliGeneral\nwsl --import KaliGeneral C:\\Users\\consultant\\AppData\\Local\\KaliGeneral .\\kali-base.tar --version 2\n```\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/d65ee216-1714-45cf-b4ac-8bc5587beba9.png\" class=\"img-fluid\" alt=\"Windows Terminal Help\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Windows Terminal Help.</figcaption>\n</figure>\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/41873b36-7aac-435e-8b51-1a6a566f0a31.png\" class=\"img-fluid\" alt=\"Windows Terminal Help - Split Pane\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Windows Terminal Help - Split Pane.</figcaption>\n</figure>\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/21ca4b80-a019-4029-b4ea-41fa193bef73.png\" class=\"img-fluid\" alt=\"Windows Terminal Help - New Tab\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Windows Terminal Help - New Tab.</figcaption>\n</figure>\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/1b6288b6-c34f-4939-b680-c11726d58814.png\" class=\"img-fluid\" alt=\"Windows Terminal Help - Focus Tab\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Windows Terminal Help - Focus Tab.</figcaption>\n</figure>\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\">\n<img src=\"/static/06677c06-0359-4f30-b953-8fb6cfd31724.png\" class=\"img-fluid\" alt=\"Two Versions Of Kali\">\n<figcaption class=\"figure-caption text-center fw-normal text-dark\">Two Versions Of Kali.</figcaption>\n</figure>\n\n## Customise Toys\n\n* Groupy\n* Taskbar X\n* T Clock\n* Power Toys\n* Everything\n* Rocket / Launcher\n* wox\n* sharex\n* ditto"},"prev":{"fields":{"slug":"/beginners-guide-to-pentesting-azure"},"excerpt":null,"frontmatter":{"date":"22nd March 2021 ","title":"Beginners Guide To Pentesting Azure","description":"This article serves as an introduction to Azure penetration testing.","tags":"azure, connect, cryptography","posttype":"article"},"body":"# Beginners Guide To Pentesting Azure\n\nLet us start by installing the Azure Active Directory PowerShell Modules.\n\n```\nInstall-Module AzureAD\n```\n\n<img src=\"fc3f3cf0-9981-42f0-8a46-62d1a50b6286.png\" class=\"img-fluid\" alt=\"Beginners Guide To Pentesting Azure\">\n\nWith the module installed we can now run the following from the command line to list all the available commands. \n\n```\nget-command -Module AzureAD\n```\n\nIf we look down the list we can see a command for connecting to Azure \n\n<img src=\"c3a9c547-7ef9-4f8d-8e5c-fd81d074a561.png\" class=\"img-fluid\" alt=\"Connecting to Azure\">\n\n```\nConnect-AzureAD\n```\n\nA pop-up should appear asking you to authenticate \n\n<img src=\"05931e0d-0154-4591-99fd-5a11d6d3f6e7.png\" class=\"img-fluid\" alt=\"\">\n\n\nIf you get the following error after trying to connect then you are possibly using PowerShell Core. \n\n`Connect-AzureAD: One or more errors occurred. (Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.): Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.\nConnect-AzureAD: One or more errors occurred. (Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.)\nConnect-AzureAD: Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.\nConnect-AzureAD: One or more errors occurred. (Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.): Could not load type 'System.Security.Cryptography.SHA256Cng' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.`\n\n\nIf you are able to successfully connect you will see a returned table showing your:\n\n* Account\n* Environment, \n* Tenant ID\n* Tenant Domain\n* Account Type\n\nWhat if you want to run cmdlets against a different Tennant. \n\n```\nConnect-AzureAD -Tenant <Tenant ID>\n```\n\nWhere can I find the Tenant ID I hear you say?\n\n### Getting the Tenant ID Via The Portal\n\n<img src=\"75cd2d95-b2cc-442f-a519-60f59b371c5d.png\" class=\"img-fluid\" alt=\"\">\n\n<img src=\"3ec7c6d8-e478-47a1-9acd-9bf7b3ab6548.png\" class=\"img-fluid\" alt=\"\">"}}},"staticQueryHashes":["310218920"],"slicesMap":{}}