{"componentChunkName":"component---src-templates-blog-post-js","path":"/articles/wsl-2-installing-metasploit-framework-with-kali-linux/","result":{"pageContext":{"post":{"fields":{"slug":"/wsl-2-installing-metasploit-framework-with-kali-linux"},"excerpt":null,"frontmatter":{"date":"25th February 2022 ","title":"WSL2 - Installing Metasploit Framework with Kali Linux","description":"This article demonstrates how to install the Metasploit Framework with Kali Linux on WSL2.","tags":"kali-linux, wsl2","posttype":"article"},"body":"\nThis article demonstrates how to install the Metasploit Framework with Kali Linux on WSL version 2. When installing Kali Linux for WSL2 using Microsoft Store, its file size is minimised by including the bare essentials by default.\n\n#Pre-requisites\n\nThis example assumes that you have the following:\n\n- Windows Subsystem For Linux version 2 (WSL2) - This example is not tested on WSL version 1\n- Kali Linux for WSL2\n\n#Instructions\n\n<h5 class=\"step\">Step 1 - Update the repositories</h5>\n\n```\nsudo apt update\n```\n\n<h5 class=\"step\">Step 2 - Install and enable PostgreSQL</h5>\n\n```\nsudo apt install postgresql\nsudo /etc/init.d/postgresql start\n```\n\n<h5 class=\"step\">Step 3 - Download the Metasploit Framework installation file</h5>\n\n```\nwget https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb\n```\n\n<h5 class=\"step\">Step 4 - Install the Metasploit Framework</h5>\n\n```\n./msfupdate.erb\n```\n\n<h5 class=\"step\">Step 5 -Verify the installation</h5>\n\nTo confirm that the Metasploit Framework was successfully installed, attempt to launch components supported by the framework.\n\nTo launch the Metasploit Framework command-line interface, run:\n\n```\nmsfconsole\n```\n\nThe below screen capture displays `msfconsole` launched with an ASCII-art banner.\n<img src=\"/static/429fbf45-6b3a-4372-8e75-15ad3e5d60cd.png\">\n![](/media/markdown/2022/02/26/)\n\nYou can use `exit` to exit msfconsole and attempt to launch the `msfvenom`, the command-line instance of Metasploit.\n\n```\nmsfconsole\n```\n\nIf the installation was successful, the help page will be displayed as demonstrated below.\n<img src=\"/static/fa427e84-580d-4edb-847d-e09776009dd1.png\">\n![](/media/markdown/2022/02/26/)"},"prev":{"fields":{"slug":"/fixing-common-errors-power-shell-remoting-from-kali"},"excerpt":null,"frontmatter":{"date":"25th February 2022 ","title":"Fixing Common Errors PowerShell Remoting From Kali","description":"In this article, I will briefly explain how to fix common issues when trying to PowerShell Remote From Kalil.","tags":"error-message, kali-linux, powershell","posttype":"article"},"body":"\nAssuming you have powershell installed on Kali. \n\n// Insert link or brief description of installing PowerShell on Kali. \n\n\n\n## Problem 1\n\nWhen you try and perform PowerShell remoting the first time you will probably see the following error. \n\n\"Enter-PSSession: This parameter set requires WSMan, and no supported WSMan client library was found. WSMan is either not installed or unavailable for this system.\" \n\n```\n┌──(consultant㉿pentest)-[~]\n└─$ pwsh \nPowerShell 7.1.4\nCopyright (c) Microsoft Corporation.\n\nhttps://aka.ms/powershell\nType 'help' to get help.\n\nPS /home/consultant> $cred = Get-Credential\n\nPowerShell credential request\nEnter your credentials.\nUser: Administrator\nPassword for user Administrator: *********\n\nPS /home/consultant> Enter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\nEnter-PSSession: This parameter set requires WSMan, and no supported WSMan client library was found. WSMan is either not installed or unavailable for this system.\nPS /home/consultant> \n```\n<img src=\"/static/86717c1c-326e-405e-a56f-4bcb1d38a049.png\">\n\n\nThe problem here is that the library is looking for packages that do not exist. \n\n\nIn this case, our PowerShell is located in the following path `/opt/microsoft/powershell/7`\n\nif we do\n```\nldd /opt/microsoft/powershell/7/libmi.so \n\tlinux-vdso.so.1 (0x00007ffc7bbe9000)\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007ff9e2e02000)\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007ff9e2dfb000)\n\tlibpam.so.0 => /lib/x86_64-linux-gnu/libpam.so.0 (0x00007ff9e2de9000)\n\tlibssl.so.1.0.0 => not found\n\tlibcrypto.so.1.0.0 => not found\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007ff9e2c0f000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007ff9e3010000)\n\tlibaudit.so.1 => /lib/x86_64-linux-gnu/libaudit.so.1 (0x00007ff9e2bdb000)\n\tlibcap-ng.so.0 => /lib/x86_64-linux-gnu/libcap-ng.so.0 (0x00007ff9e2bd3000)\n\n```\n\n<img src=\"/static/adfdb756-450d-4869-a4d9-f6862bb0ba16.png\">\n\n\nIn that directory, we need to add our symlinks:\n\n\n```\ncd /usr/lib/x86_64-linux-gnu \nsudo ln -s /usr/lib/x86_64-linux-gnu/libssl.so.1.0.2 libssl.so.1.0.0\nsudo ln -s /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.2 libcrypto.so.1.0.0\n```\n<img src=\"/static/0743039e-e8ad-49d5-9d64-91588530b5f6.png\">\n\n\nNow fixed!\n\n\n## Problem 2\n\nYou get a `MI_RESULT_ACCESS_DENIED` error message.\n```\nEnter-PSSession : MI_RESULT_ACCESS_DENIED\n```\n\nThis is probably because you missed off the `-Authentication` flag on your command\n\nCheck if you are typing in something like this\n```\nEnter-PSSession -ComputerName 192.168.1.235 -Credential $cred \n```\n\nThe solution is to use `-Authentication Negotiate`\n```\nEnter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\n```\n\n\n## Problem 3\n\nErrors with non-Kerberos authentication i.e. because you are not domain-joined\n\nIf you have seen this error when trying to connect with Negotiate because you are not domain-joined. \n\n\"Enter-PSSession: Connecting to remote server 192.168.1.235 failed with the following error message : acquiring creds with username only failed An invalid name was supplied SPNEGO cannot find mechanisms to negotiate For more information, see the about_Remote_Troubleshooting Help topic.\"\n\nFrom trying to type in a command such as \n```\nPS /home/consultant> Enter-PSSession -ComputerName 192.168.1.235 -Credential $cred -Authentication Negotiate\nEnter-PSSession: Connecting to remote server 192.168.1.235 failed with the following error message : acquiring creds with username only failed An invalid name was supplied SPNEGO cannot find mechanisms to negotiate For more information, see the about_Remote_Troubleshooting Help topic.\n```\n<img src=\"/static/7a048cd7-7167-4242-9c30-710c29d5b01b.png\">\n\n\nThis is because you need the following package installed on your kali Linux\n```\nsudo apt-get install gss-ntlmssp\n```\n\nAfter this, you should be able to connect."},"next":{"fields":{"slug":"/security-log-reference"},"excerpt":null,"frontmatter":{"date":"17th February 2022 ","title":"Security Log Reference","description":"This article serves as a quick reference for Windows Security Log event IDs.","tags":"security-logs, windows","posttype":"article"},"body":"This article serves as a quick reference for Windows Security Log event IDs.\n\n# Windows Security Log Reference\n\nTo Open the security log run\n```\neventvwr.msc\n```\n\nThen in the console tree, expand Windows Logs, and then click Security. The results pane lists individual security events.\n\n## User Account Changes\n\n| Event ID | Description                                  |\n|----------|----------------------------------------------|\n| 4720     | Created                                      |\n| 4722     | Enabled                                      |\n| 4723     | User changed own password                    |\n| 4724     | Privileged User changed this user's password |\n| 4725     | Disabled                                     |\n| 4726     | Deleted                                      |\n| 4738     | Changed                                      |\n| 4740     | Locked out                                   |\n| 4767     | Unlocked                                     |\n| 4781     | Name change                                  |\n\n## Domain Controller Authentication Events\n\n\n| Event ID | Description                                                                                |\n|----------|--------------------------------------------------------------------------------------------|\n| 4768     | A Kerberos authentication ticket (TGT) was requested                                       |\n| 4771     | Kerberos pre-authentication failed                                                         |\n| 4820     | A Kerberos TGT was denied because the device does not meet the access control restrictions |\n\n\n## Logon Session Events (Correlate by Logon ID)\n\n| Event ID | Description                             |\n|----------|-----------------------------------------|\n| 4624     | Successful logon                        |\n| 4647     | User initiated logoff                   |\n| 4625     | Logon failure {See Logon Failure Codes) |\n| 4778     | Remote desktop session reconnected      |\n| 4779     | Remote desktop session disconnected     |\n| 4800     | Workstation locked                      |\n| 4801     | Workstation unlocked                    |\n| 4802     | Screen saver invoked                    |\n| 4803     | Screen saver dismissed                  |\n\n## Logon Types\n\n| Type ID | Description                   |\n|---------|-------------------------------|\n| 2       | Interactive                   |\n| 3       | Network (i.e. mapped drive)   |\n| 4       | Batch                         |\n| 5       | Service (service startup)     |\n| 7       | Unlock                        |\n| 8       | Network Cleartext             |\n| 10      | Remote Desktop                |\n| 11      | Logon with cached credentials |\n\n\n## Security Group Changes\n\n\n| Action         | Local | Global | Universal |\n|----------------|-------|--------|-----------|\n| Created        | 4731  | 4727   | 4754      |\n| Changed        | 4735  | 4737   | 4755      |\n| Deleted        | 4734  | 4730   | 4758      |\n| Member Added   | 4732  | 4728   | 4756      |\n| Member Removed | 4733  | 4729   | 4757      |\n\n\n## Distribution Group Changes\n\n| Action         | Local | Global | Universal |\n|----------------|-------|--------|-----------|\n| Created        | 4744  | 4749   | 4759      |\n| Changed        | 4745  | 4750   | 4760      |\n| Deleted        | 4748  | 4753   | 4763      |\n| Member Added   | 4746  | 4751   | 4761      |\n| Member Removed | 4747  | 4752   | 4762      |"}}},"staticQueryHashes":["310218920"],"slicesMap":{}}